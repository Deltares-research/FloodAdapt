---
title:	Flood Adapt Model Builder - Graphical User Interface
filters:
  - lightbox
lightbox: auto
execute:
  echo: false
jupyter: python3
---

The Hydromt FIAT Graphical User Interface (GUI), also refered to as **Flood Adapt Model Builder (FIAT)**, facilitates the process of setting up the **Delft FIAT** model, thus making the **Delft FIAT** model creation accessible for users without modeling experience . 

# Setup Guide
## Installation
To run the Floodadapt model builder you need to install two tools:

  1. **HydroMT FIAT**
  2. **DelftDashboard**

#### HydroMT FIAT
HydroMT-FIAT is available from pypi and will be added to conda-forge (in progress).

To install hydromt_fiat for usage, do:

  > pip install hydromt_fiat

#### DelftDashboard
For the Graphical User Interface you additionally need to set up **DelftDashboard**.You can find the installation guide [here](https://github.com/Deltares-research/DelftDashboard/blob/FloodAdapt_ModelBuilders/README.md).

# User Guide
After you open the GUI you must select a model output directory before you start.
*GUI instructions*
  
  1, Go to **File** >> **Select Working Directory**.

Now you are ready to set up the model.

## Create Model Boundary

There are multiple options on how to create the model boundaries:

  * Draw polygon/ draw box  
  * Upload Sfincs boundaries  
  * Upload file (polygon vector file)

![Workflow to create model boundaries.](../../_static/figures/Draw_boundaries.svg){#fig-boundaries}

*GUI instructions*

  1. Go to the **Model Boundary | Quickbuild** -tab and select any of the options in the drop-down menu to create the boundary (@fig-boundaries).
  2. As soon you are done click "**Generate boundary**" and your model boundary is established.

For further details please refer to @fig-model_boundaries.

::: {#fig-model_boundaries}

{{< video ../../_static/videos/hydromt_fiat/Generate_Boundaries.mp4 >}}

Create model boundaries using the "Draw Polygon" method.

:::

## Quickbuild
If you set up a model in the United States and do not want to use your own data you can simply choose to work with the **quickbuild**. 

The **quickbuild** downloads the data from different sources:  

* **Exposure**: National Structure Inventory (NSI)
* **Vulnerability curves**: FEMA’s Hazus Program
* **Social vulnerability index**/**equity**: Census api
* **Roads**: Open Street Map (OSM)

*GUI instructions*

  1. Go to the **Model Boundary | Quickbuild** -tab and select any of the options in the drop-down menu to create the boundary (@fig-boundaries).
  2. After you generated the model boundaries you can select the quickbuild option in the same tab in the GUI (@fig-quickbuild)

![Workflow to use the "Quickbuild"-option.](../../_static/figures/Quickbuild.svg){#fig-quickbuild}

For further details please refer to (@fig-nsi_quickbuild).

::: {#fig-nsi_quickbuild}

{{< video ../../_static/videos/hydromt_fiat/Quickbuild.mp4 >}}

Quickbuild option in the United States.

:::

## Model from scratch: A simple model
This section explains the creation of a simple model without additional input by the user. This can be set up globally or in the United States.  
After you created your model boundaries (please refer to Chapter Create Model Boundary) pick-up here. 

### Create the exposure data
There are two different databases to download the **exposure data** from, depending on where you want to set up your model:

1. **United States: National Structure Inventory**
2. **Global: Open Street Map**

Additionally, you can download **road data** from Open Street Map. 

*GUI instructions*  
To set up the exposure open the **"Exposure"**-tab on the top panel (@fig-exposure). 

  1. Select the **"Asset Location"**-tab at the bottom panel
  2. For a U.S. based model start with **NSI** data and for a global model start with **OSM** data
  3. **only OSM**: Define a <u>damage currency</u> and the <u>finished floor height</u> for all assets (can be updated later on hthe individual asset level in the advanced model) 
  4. **optional**: Include OSM roads by checking the checkbox "Include OSM roads" 
  5. Add to model.
  

![Workflow to setup exposure data.NSI(National Structure Inventory), OSM (Open Street Map).](../../_static/figures/Exposure.svg){#fig-exposure}

These are all the steps that are required to set up the exposure for a **simple model**. If you want to update the model or input your own data please refer to the section ***Model from scratch: Advanced model***, in which the additional tabs of the bottom panel are discussed such as *Finished Floor Height* or *Max. Potential Damages*. 

The videos below show the exposure setup using the National Structure Inventory (NSI) data with the Open  Street Map (OSM) data for roads (@fig-nsi_exposure) and the exposure setup for a global model, using OSM data (incl. roads) (@fig-osm_exposure).

::: {#fig-nsi_exposure}

{{< video ../../_static/videos/hydromt_fiat/Exposure_NSI.mp4 >}}

Exposure setup using NSI data.

:::


::: {#fig-osm_exposure}

{{< video ../../_static/videos/hydromt_fiat/Exposure_OSM.mp4 >}}

Exposure setup using OSM data.

:::

### Assign vulnerability curves
As a next step you must assign the vulnerability curves to the exposure data. There are two data sources from which the vulnerability curves are downloaded from, depending on the location of your model:

1. **United States: FEMA Hazus Curves**
2. **global: JRC Vulnerability Curves**

*GUI instructions*  
To set up the exposure open the **"Vulnerability"**-tab on the top panel (@fig-vulnerability_curve). 

  1. The GUI will automatically select the correct <u>default curves</u> for your model based upon your exposure data (NSI or global). Therefore, you only need to add the curves to the model without further adjustment. For detailed information about the default curves please refer to [Data Input](data_input.qmd).

  2. ***only NSI***: If desired, you can specify different curves from the default  by selecting "Specify different damage curves". First, select the asset you want to assign another damage curve to and second, select a new damage curve. 

![Workflow to assign vulnerability curves to assets with option to update default NSI vulnerability curves.](../../_static/figures/vulnerability.svg){#fig-vulnerability_curve}

You can follow the steps in the video below (@fig-vulnerability).

::: {#fig-vulnerability}

{{< video ../../_static/videos/hydromt_fiat/NSI_Vulnerability.mp4 >}}

Assign the default vulnerability curves to the exposure data. 

:::


### Create model
At this point, you are ready to create the **D assureelft FIAT model**. Verify the data sources in the bottom tab, and verify that they match your previous model input. If so, create your model (@fig-create_model).

::: {#fig-create_model}

{{< video ../../_static/videos/hydromt_fiat/Create_model_OSM.mp4 >}}

Create your **Delft FIAT model**. 

:::

### Additional features
#### Social Vulnerability Index (SVI) and Equity
**Delft FIAT** allows you to evaluate the equitible distribution of damages and benefits by using the **social vulnerability index** and **equity**. If your model site is located in the United States, SVI data can be calculated based upon recent literature. 
However, the user has the freedom to upload any social vulnerability index and/or equity layer in form of a **vector file** (e.g. *.gpkg*, *.geojson*) and assign a value to each asset that overlaps the layer at any location (@fig-additional_attr).

*GUI instructions*  
Follow these instructions when setting up a model in the **United States**

  1. In the top panel, select *"SVI + Equity"*.
  2. In the bottom panel, select the year you wish to download data frame.
  3. Check the checkboxes to download, SVI and/or Equity data.

If your model is setup in a location outside the U.S please refer to Chapter **Additional attributes** for instructions. 

For a detailed demonstration please refer to @fig-additional_attr.

#### Additional attribtues
Not only social vulnerability and/or equity can be linked to the exposure data. Any additional layer (e.g. landuse, administrative boundaries or others) can be addedd (@fig-additional_attr). The additional attribute layer must be a **vector file** (e.g. *.gpkg*, *.geojson*) in the same location of your model. 

*GUI instructions*  
If you wish to add **SVI** and/or **Equity** follow these intstructions. The same instructions apply 1for any aggregation layer or additional attribute you wish to add on your model. 

![GUI instructions flowchart](../../_static/figures/svi_flowchart.svg)

  1. In the top panel, select *"Additional Attributes"*.
  2. In the bottom panel *"Add new Source"*, select the **source** of your vector layer and **load** it into the model. 
  3. In the bottom panel *"Select attribute"*, select the **Attribute ID** from the dropdown menu. If you loaded in your file corretly the drop-down menu includes all columns of your data file. Select the column of the attribute/aggregation you wish to impose on your model. 
  4. In the bottom panel *"Select attribute"*, give your layer a **Label** (free-text). This label will be the header for your new additional attribute/aggregation layer in the output data. 
  5. In the bottom panel *"Select attribute"*, click **Add** to add the new layer and the layer will appear in the table in the bottom panel *"Overview attribute"*. 
  6. In the bottom panel *"Overview attribute"*, you can check the checkbox **"Display Attribute"** to verify the correct output of the vector layer. 
  7. You can repeat this process as many layers as you wish.
  8. As soon you added all the layers you wish to impose, select *"Add to model"* and your new additional attributes/aggregation layer is added to your final model. 

For a detailed demonstration please refer to @fig-additional_attr.

::: {#fig-additional_attr}

{{< video ../../_static/videos/hydromt_fiat/SVI_Additional_Attributes_NSI.mp4 >}}

Create your Delft FIAT model. 

:::

### Floodadapt Model Builder output

After creating your model you should end up with a folder structure as shown below to ensure that FIAT can find each data file and run smoothly. 

```

├───📁 FIAT/
    |
    ├───📁 hazard/
    │   └───📄 This will be empty
    |
    ├───📁 exposure/
    │   ├───📄 buildings.gpkg
    │   └───📄 exposure.csv
    |
    ├───📁 vulnerability/
    │   └───📄 vulnerability_curves.csv
    |
    └───📄 settings.toml

```
